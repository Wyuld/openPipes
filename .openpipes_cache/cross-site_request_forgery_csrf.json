{
  "title": "Cross-site Request Forgery (CSRF)",
  "cvssv3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N",
  "description": "Um ataque CSRF tem como objetivo induzir um usuário a executar inadvertidamente uma funcionalidade em um aplicativo web vulnerável, o que será benéfico para o invasor e prejudicial para o usuário afetado. Especificamente, o ataque é realizado forçando o navegador de um usuário desavisado a fazer uma solicitação ao site vulnerável, uma solicitação que o usuário realizará sem perceber e que será bem-sucedida enquanto o usuário estiver conectado ao site, pois as credenciais já estabelecidas (ID da sessão, cookies,...) serão usadas automaticamente. Ao contrário dos ataques XSS, que exploram a confiança que um usuário tem em um site específico, a Falsificação de Solicitação Entre Sites explora a confiança que um site tem em um usuário específico. Esta é uma vulnerabilidade de autenticação insuficiente na qual o aplicativo não valida corretamente a origem da solicitação.",
  "observation": "Controle de Acesso: DoS: Travar, Sair ou Reiniciar: As consequências variam dependendo da natureza da funcionalidade vulnerável ao CSRF. Um invasor pode efetivamente executar qualquer operação como vítima. Se a vítima for um administrador ou usuário privilegiado, as consequências podem incluir obter controle total sobre o aplicativo web – excluindo ou roubando dados, desinstalando o produto ou usando-o para lançar outros ataques contra todos os usuários do produto. Como o invasor tem a identidade da vítima, o escopo do CSRF é limitado apenas pelos privilégios da vítima.",
  "remediation": "Para evitar ataques de Cross-Site Request Forgery, é necessário que cada solicitação feita ao site contenha um identificador único (um token sincronizador), que deve ser um parâmetro que o invasor não consiga descobrir. Por exemplo, sugere-se enviar como parâmetro o identificador de sessão do usuário legítimo. O servidor deve verificar esse parâmetro como forma de validar que é de fato o usuário atual que está solicitando a operação atual. Além disso, a interação do usuário pode ser solicitada para transações confidenciais como uma forma de autenticação dupla ou respondendo a um CAPTCHA. Além disso, o cabeçalho REFERER na solicitação do cliente deve ser verificado para garantir que cada solicitação esteja vindo do site original e não de uma fonte externa. Essa mitigação, embora necessária, pode ser contornada por um invasor que utilize outros tipos de vulnerabilidades, como XSS.",
  "references": [
    "https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery",
    "https://cwe.mitre.org/data/definitions/352.html"
  ]
}
