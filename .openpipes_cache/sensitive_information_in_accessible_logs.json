{
  "title": "Sensitive Information in Accessible Logs",
  "cvssv3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
  "description": "Um log é um registro das atividades que ocorrem dentro das redes e sistemas de uma organização. Logs são compostos por entradas de log, e cada entrada contém detalhes sobre um evento específico que ocorreu em um sistema ou rede.",
  "observation": "Confidencialidade: Ler Dados da Aplicação: O atacante pode ser capaz de ler informações sensíveis",
  "remediation": "É recomendado manter os logs em um local separado e não no próprio servidor web. Isso também facilita a agregação de logs de diferentes fontes que se referem à mesma aplicação (como em um farm de servidores web) e facilita a análise de logs (que pode ser intensiva em CPU) sem impactar o servidor.Também é recomendado implementar rotação de logs garantindo que:Os logs sejam mantidos pelo tempo definido na política de segurança, nem mais nem menos.Os logs sejam comprimidos após a rotação (isso é conveniente, pois permitirá armazenar mais logs no mesmo espaço de disco).As permissões do sistema de arquivos dos arquivos de log rotacionados sejam as mesmas (ou mais restritivas) do que as dos arquivos de log originais. Por exemplo, servidores web precisam escrever nos logs que usam, mas não precisam escrever nos logs já rotacionados, permitindo que as permissões sejam alteradas no momento da rotação para evitar modificações pelo processo do servidor web.Alguns servidores podem rotacionar os logs quando atingem certo tamanho. Caso isso aconteça, garanta que um atacante não possa forçar a rotação de logs para esconder seus rastros.Por fim, implemente controle de acesso para que as informações dos logs nunca sejam visíveis para usuários finais e analise os logs periodicamente, por exemplo, com base em mensagens de erro:Mensagens de erro 40x (não encontrado). Um grande número vindo da mesma origem pode indicar o uso de ferramentas de varredura CGI contra o servidor web.Mensagens 50x (erro do servidor). Podem indicar que um atacante está explorando partes da aplicação que falham inesperadamente. Por exemplo, estágios iniciais de ataques de injeção SQL podem gerar essas mensagens quando a query não está bem construída.Estatísticas ou análises de logs não devem ser geradas, nem armazenadas, no mesmo servidor que produz os logs. Caso contrário, um atacante pode, através de vulnerabilidade ou configuração incorreta do servidor web, acessá-los e obter informações semelhantes às reveladas pelos próprios arquivos de log.",
  "references": [
    "https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/02-Test_Application_Platform_Configuration",
    "https://cwe.mitre.org/data/definitions/532.html"
  ]
}
